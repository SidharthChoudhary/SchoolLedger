{% extends "website/base.html" %}
{% block title %}My Profile{% endblock %}
{% block content %}

<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
  <h2 style="margin:0;">My Profile</h2>
  <a href="{% url 'edit_profile' %}" style="padding: 10px 20px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; font-weight: 600;">Edit Profile</a>
</div>

<div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px;">
  <!-- Profile Card -->
  <div class="card">
    <div style="text-align: center; padding: 20px 0;">
      {% if profile.profile_image %}
        <img src="{{ profile.profile_image.url }}" alt="{{ profile.full_name }}" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin-bottom: 15px; border: 4px solid #dbeafe;">
      {% else %}
        <div style="width: 120px; height: 120px; border-radius: 50%; background: #dbeafe; display: flex; align-items: center; justify-content: center; margin: 0 auto 15px; font-size: 48px; color: #1e40af;">
          ðŸ‘¤
        </div>
      {% endif %}
      <h3 style="margin: 0 0 5px 0;">{{ profile.full_name }}</h3>
      <p style="margin: 0; color: #6b7280;">@{{ profile.user.username }}</p>
    </div>
    
    <div style="border-top: 1px solid #e5e7eb; padding-top: 15px;">
      <h4 style="margin-top: 0; margin-bottom: 10px; font-size: 14px;">Assigned Roles</h4>
      <div style="display: flex; flex-direction: column; gap: 8px;">
        {% for role_name in roles %}
          <span style="display: inline-block; background: #dbeafe; color: #1e40af; padding: 6px 12px; border-radius: 4px; font-size: 12px; font-weight: 600; text-align: center;">{{ role_name }}</span>
        {% empty %}
          <p style="color: #9ca3af; margin: 0;">No roles assigned</p>
        {% endfor %}
      </div>
    </div>
  </div>
  
  <!-- Profile Details -->
  <div>
    <!-- Basic Information -->
    <div class="card" style="margin-bottom: 20px;">
      <h3 style="margin-top: 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Basic Information</h3>
      
      <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; padding: 15px 0;">
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Full Name</label>
          <p style="margin: 5px 0 0 0;">{{ profile.full_name }}</p>
        </div>
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Username</label>
          <p style="margin: 5px 0 0 0;">{{ profile.user.username }}</p>
        </div>
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Email</label>
          <p style="margin: 5px 0 0 0;">{{ profile.user.email|default:"â€”" }}</p>
        </div>
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Phone</label>
          <p style="margin: 5px 0 0 0;">{{ profile.phone|default:"â€”" }}</p>
        </div>
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Gender</label>
          <p style="margin: 5px 0 0 0;">{{ profile.get_gender_display|default:"â€”" }}</p>
        </div>
        <div>
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Department</label>
          <p style="margin: 5px 0 0 0;">{{ profile.department|default:"â€”" }}</p>
        </div>
        <div style="grid-column: 1 / -1;">
          <label style="font-weight: 700; color: #6b7280; font-size: 12px;">Bio</label>
          <p style="margin: 5px 0 0 0;">{{ profile.bio|default:"â€”" }}</p>
        </div>
      </div>
    </div>
    
    <!-- Account Status -->
    <div class="card">
      <h3 style="margin-top: 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Account Status</h3>
      
      <div style="padding: 15px 0;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <span style="font-weight: 700;">Account Active</span>
          {% if profile.user.is_active %}
            <span style="background: #dcfce7; color: #166534; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600;">Yes</span>
          {% else %}
            <span style="background: #fee2e2; color: #991b1b; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600;">No</span>
          {% endif %}
        </div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <span style="font-weight: 700;">Email Verified</span>
          {% if profile.is_verified %}
            <span style="background: #dcfce7; color: #166534; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600;">Yes</span>
          {% else %}
            <span style="background: #fef3c7; color: #92400e; padding: 4px 12px; border-radius: 4px; font-size: 12px; font-weight: 600;">Pending</span>
          {% endif %}
        </div>
        
        <div style="border-top: 1px solid #e5e7eb; padding-top: 15px; font-size: 12px; color: #6b7280;">
          <p style="margin: 5px 0;">Member since: {{ profile.created_at|date:"M d, Y" }}</p>
          {% if profile.user.last_login %}
            <p style="margin: 5px 0;">Last login: {{ profile.user.last_login|date:"M d, Y H:i" }}</p>
          {% else %}
            <p style="margin: 5px 0;">Last login: Never</p>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
