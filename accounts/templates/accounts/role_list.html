{% extends "website/base.html" %}
{% block title %}Role Management{% endblock %}
{% block content %}

<h2 style="margin-top:0;">Role Management</h2>

<!-- Filter -->
<div class="card" style="margin-bottom: 20px;">
  <form method="get" style="display: flex; gap: 10px; align-items: flex-end;">
    <div>
      <label style="font-weight: 700; display: block; margin-bottom: 5px;">Filter by Status</label>
      <select name="status" style="padding: 8px; border: 1px solid #d1d5db; border-radius: 6px; height: 40px;">
        <option value="all" {% if status_filter == 'all' %}selected{% endif %}>All Roles</option>
        <option value="active" {% if status_filter == 'active' %}selected{% endif %}>Active</option>
        <option value="inactive" {% if status_filter == 'inactive' %}selected{% endif %}>Inactive</option>
      </select>
    </div>
    <button type="submit" style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; height: 40px;">Filter</button>
  </form>
</div>

<!-- Roles Grid -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
  {% for role in roles %}
    <div class="card" style="display: flex; flex-direction: column;">
      <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
        <div>
          <h3 style="margin: 0 0 5px 0; font-size: 18px;">{{ role.display_name }}</h3>
          <p style="margin: 0; color: #6b7280; font-size: 12px;">{{ role.name }}</p>
        </div>
        <span style="display: inline-block; {% if role.is_active %}background: #dcfce7; color: #166534;{% else %}background: #fee2e2; color: #991b1b;{% endif %} padding: 4px 12px; border-radius: 4px; font-size: 11px; font-weight: 600;">
          {% if role.is_active %}Active{% else %}Inactive{% endif %}
        </span>
      </div>
      
      <p style="margin: 0 0 12px 0; color: #6b7280; font-size: 14px; flex-grow: 1;">{{ role.description|truncatewords:15 }}</p>
      
      <div style="border-top: 1px solid #e5e7eb; padding-top: 12px; margin-top: auto;">
        <p style="margin: 0 0 8px 0; font-weight: 700; font-size: 12px;">Permissions ({{ role.permissions.count }})</p>
        <div style="max-height: 100px; overflow-y: auto; font-size: 12px;">
          {% for perm in role.permissions.all %}
            <div style="background: #f3f4f6; padding: 4px 8px; margin: 4px 0; border-radius: 4px; color: #374151;">
              {{ perm.codename }}
            </div>
          {% empty %}
            <p style="margin: 0; color: #9ca3af;">No permissions assigned</p>
          {% endfor %}
        </div>
      </div>
      
      <div style="border-top: 1px solid #e5e7eb; padding-top: 12px; margin-top: 12px;">
        <a href="{% url 'role_detail' role.id %}" style="display: inline-block; padding: 6px 12px; background: #3b82f6; color: white; text-decoration: none; border-radius: 4px; font-size: 12px; font-weight: 600;">View Details</a>
      </div>
    </div>
  {% empty %}
    <div class="card" style="grid-column: 1 / -1; text-align: center; padding: 40px;">
      <p style="color: #9ca3af; font-size: 16px;">No roles found</p>
    </div>
  {% endfor %}
</div>

{% endblock %}
